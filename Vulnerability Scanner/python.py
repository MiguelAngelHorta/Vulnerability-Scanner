import flask
import requests

app = flask.Flask(__name__)

vulnerabilities = []

def scan_website(url):
    try:
        response = requests.get(url)
        response.raise_for_status()

        if any(error in response.text for error in ["error", "invalid"]):
            vulnerabilities.append({
                "url": url,
                "severity": "High",
                "description": "Potential vulnerability detected in response text.",
                "detail": response.text  # Include detail of the issue
            })
    except requests.exceptions.RequestException as e:
        vulnerabilities.append({
            "url": url,
            "severity": "High",
            "description": f"Error encountered while scanning: {str(e)}",
            "detail": str(e)  # Include detail of the error
        })

@app.route("/")
def dashboard():
    severity_counts = {}
    for vulnerability in vulnerabilities:
        severity = vulnerability["severity"]
        severity_counts[severity] = severity_counts.get(severity, 0) + 1

    return flask.render_template("dashboard.html", vulnerabilities=vulnerabilities, severity_counts=severity_counts)

if __name__ == "__main__":
    target_url = input("Enter the URL to scan: ")
    scan_website(target_url)
    app.run(debug=True)
